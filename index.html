<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>üéÑ –ù–æ–≤–æ–≥–æ–¥–Ω–∏–π —Ç–µ—Å—Ç –õ—é—à–µ—Ä–∞ 2026</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root {
      --bg: linear-gradient(135deg, #0c1b2c 0%, #1a2b3c 50%, #0f172a 100%);
      --panel: rgba(16, 36, 64, 0.95);
      --text: #f0f8ff;
      --muted: #b8d4ff;
      --primary: #2dd4bf;
      --secondary: #ff3366;
      --gold: #ffd700;
      --silver: #c0c0c0;
      --success: #34a853;
      --radius: 20px;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      height: 100%;
      overflow-x: hidden;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      line-height: 1.6;
      position: relative;
      min-height: 100vh;
    }

    /* –°–Ω–µ–∂–∏–Ω–∫–∏ */
    .snowflake {
      position: fixed;
      background: white;
      border-radius: 50%;
      opacity: 0.8;
      animation: fall linear infinite;
      z-index: 1;
      pointer-events: none;
    }

    @keyframes fall {
      0% {
        transform: translateY(-100px) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }

    /* –ù–æ–≤–æ–≥–æ–¥–Ω–∏–µ –æ–≥–æ–Ω—å–∫–∏ */
    .lights {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: linear-gradient(90deg, 
        #ff0000, #ff9900, #ffff00, #00ff00, 
        #00ffff, #0000ff, #9900ff, #ff0000
      );
      background-size: 800% 100%;
      animation: lightsMove 20s linear infinite;
      z-index: 2;
    }

    @keyframes lightsMove {
      0% { background-position: 0% 50%; }
      100% { background-position: 800% 50%; }
    }

    /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
      width: 100%;
    }

    /* –®–∞–ø–∫–∞ */
    .header {
      background: rgba(8, 28, 50, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 2px solid rgba(45, 212, 191, 0.3);
      padding: 1rem 0;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 10px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 700;
      font-size: 1.2rem;
    }

    .logo-icon {
      font-size: 1.5rem;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
    .main-content {
      padding: 2rem 0 4rem;
      min-height: calc(100vh - 140px);
      display: flex;
      align-items: center;
    }

    .screen {
      display: none;
      width: 100%;
    }

    .screen.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* –ö–∞—Ä—Ç–æ—á–∫–∞ */
    .card {
      background: var(--panel);
      border: 2px solid rgba(45, 212, 191, 0.2);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow: hidden;
      max-width: 900px;
      margin: 0 auto;
    }

    /* –≠–∫—Ä–∞–Ω—ã */
    .welcome-screen {
      text-align: center;
      padding: 3rem 2rem;
    }

    .title {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, var(--primary), var(--gold), var(--secondary));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }

    .year-2026 {
      color: var(--gold);
      font-size: 3rem;
      margin: 0.5rem 0;
      text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
      animation: glow 2s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { text-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
      to { text-shadow: 0 0 25px rgba(255, 215, 0, 0.8); }
    }

    @media (max-width: 768px) {
      .title {
        font-size: 2rem;
      }
      .year-2026 {
        font-size: 2.2rem;
      }
    }

    .subtitle {
      font-size: 1.2rem;
      color: var(--muted);
      margin-bottom: 2rem;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    /* –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è */
    .instructions {
      background: rgba(12, 27, 44, 0.6);
      border: 1px solid rgba(45, 212, 191, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
      margin: 2rem auto;
      max-width: 700px;
    }

    .instructions-title {
      color: var(--primary);
      font-size: 1.3rem;
      margin-bottom: 1rem;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .steps {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      counter-reset: step-counter;
    }

    .step {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      padding: 0.5rem;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
      transition: transform 0.3s ease;
    }

    .step:hover {
      transform: translateX(5px);
      background: rgba(255, 255, 255, 0.1);
    }

    .step::before {
      counter-increment: step-counter;
      content: counter(step-counter);
      background: var(--primary);
      color: white;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      font-weight: bold;
    }

    .step-content {
      flex: 1;
    }

    .step-title {
      font-weight: 600;
      margin-bottom: 0.3rem;
      color: var(--text);
    }

    .step-desc {
      color: var(--muted);
      font-size: 0.95rem;
    }

    /* –ü–∞–Ω–µ–ª—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
    .progress-panel {
      background: rgba(8, 28, 50, 0.9);
      padding: 1.5rem;
      border-bottom: 2px solid rgba(45, 212, 191, 0.3);
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      flex-wrap: wrap;
      gap: 10px;
    }

    .phase-badge {
      background: linear-gradient(135deg, var(--primary), #22c55e);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-weight: 600;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .counter {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-weight: 600;
      font-size: 0.9rem;
    }

    .progress-container {
      margin: 1rem 0;
    }

    .progress-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
      color: var(--muted);
    }

    .progress-bar {
      height: 12px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      width: 0%;
      transition: width 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .progress-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    /* –°–µ—Ç–∫–∞ —Ü–≤–µ—Ç–æ–≤ */
    .colors-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 1.5rem;
      padding: 2rem;
    }

    @media (max-width: 768px) {
      .colors-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        padding: 1.5rem;
      }
    }

    @media (max-width: 480px) {
      .colors-grid {
        grid-template-columns: 1fr;
      }
    }

    .color-card {
      aspect-ratio: 1;
      border-radius: 20px;
      position: relative;
      cursor: pointer;
      overflow: hidden;
      border: 3px solid transparent;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
    }

    .color-card:hover:not(.selected) {
      transform: translateY(-5px) scale(1.05);
      border-color: var(--gold);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
    }

    .color-card.selected {
      animation: selectPulse 0.5s ease;
      border-color: var(--success);
      opacity: 0.3;
      cursor: default;
      transform: scale(0.95);
    }

    @keyframes selectPulse {
      0% { transform: scale(1); }
      50% { transform: scale(0.9); }
      100% { transform: scale(0.95); }
    }

    .selected-badge {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: var(--success);
      color: white;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      z-index: 2;
      animation: badgeAppear 0.3s ease;
    }

    @keyframes badgeAppear {
      from { transform: translate(-50%, -50%) scale(0); }
      to { transform: translate(-50%, -50%) scale(1); }
    }

    .color-info {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      padding: 1rem;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    .color-card:hover .color-info {
      transform: translateY(0);
    }

    .color-name {
      font-weight: 600;
      font-size: 1.1rem;
      margin-bottom: 0.3rem;
    }

    .color-desc {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.8);
    }

    /* –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
    .results-screen {
      padding: 2.5rem;
    }

    .results-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .results-title {
      font-size: 2rem;
      margin-bottom: 1rem;
      color: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }

    .results-subtitle {
      color: var(--muted);
      max-width: 600px;
      margin: 0 auto 2rem;
    }

    /* –ì—Ä—É–ø–ø—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
    .results-groups {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .result-group {
      background: rgba(12, 27, 44, 0.7);
      border-radius: 15px;
      padding: 1.5rem;
      border: 1px solid rgba(45, 212, 191, 0.2);
      transition: transform 0.3s ease;
    }

    .result-group:hover {
      transform: translateY(-5px);
    }

    .group-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 1rem;
      color: var(--gold);
      font-size: 1.2rem;
      font-weight: 600;
    }

    .group-content {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .color-tag {
      background: rgba(255, 255, 255, 0.1);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-size: 0.9rem;
      transition: all 0.3s ease;
    }

    .color-tag:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }

    /* –ù–æ–≤–æ–≥–æ–¥–Ω—è—è –∏—Å—Ç–æ—Ä–∏—è */
    .story-container {
      background: linear-gradient(135deg, rgba(45, 212, 191, 0.1), rgba(255, 51, 102, 0.1));
      border: 2px solid var(--gold);
      border-radius: 20px;
      padding: 2rem;
      margin: 2rem 0;
      position: relative;
      overflow: hidden;
    }

    .story-container::before {
      content: '‚ú®';
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 2rem;
      animation: sparkle 2s infinite;
    }

    @keyframes sparkle {
      0%, 100% { opacity: 0.5; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.2); }
    }

    .story-title {
      color: var(--gold);
      font-size: 1.5rem;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .story-content {
      font-size: 1.1rem;
      line-height: 1.7;
      color: var(--text);
      margin-bottom: 1.5rem;
    }

    .new-year-wish {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(45, 212, 191, 0.2));
      border-left: 4px solid var(--gold);
      padding: 1.5rem;
      border-radius: 10px;
      margin-top: 1.5rem;
      font-style: italic;
      color: var(--muted);
      position: relative;
    }

    .new-year-wish::before {
      content: 'üéÜ';
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 1.5rem;
      background: var(--panel);
      padding: 0 10px;
    }

    /* –ö–Ω–æ–ø–∫–∏ */
    .btn {
      border: none;
      border-radius: 12px;
      padding: 1rem 2rem;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: 0.5s;
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary), #22c55e);
      color: white;
      box-shadow: 0 4px 20px rgba(45, 212, 191, 0.4);
    }

    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(45, 212, 191, 0.5);
    }

    .btn-secondary {
      background: rgba(255, 51, 102, 0.15);
      color: var(--secondary);
      border: 2px solid rgba(255, 51, 102, 0.3);
    }

    .btn-secondary:hover {
      background: rgba(255, 51, 102, 0.25);
      transform: translateY(-3px);
    }

    .btn-group {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 2rem;
      flex-wrap: wrap;
    }

    /* –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
    .results-output {
      margin-top: 2rem;
    }

    .results-textarea {
      width: 100%;
      min-height: 200px;
      background: rgba(12, 27, 44, 0.8);
      color: var(--text);
      border: 2px solid rgba(45, 212, 191, 0.3);
      border-radius: 12px;
      padding: 1.5rem;
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      resize: vertical;
      line-height: 1.5;
    }

    .results-textarea:focus {
      outline: none;
      border-color: var(--primary);
    }

    /* –ü–æ–¥—Å–∫–∞–∑–∫–∞ */
    .hint {
      text-align: center;
      color: var(--muted);
      font-size: 0.9rem;
      margin-top: 1rem;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* –ü–æ–¥–≤–∞–ª */
    .footer {
      background: rgba(8, 28, 50, 0.95);
      backdrop-filter: blur(10px);
      border-top: 2px solid rgba(45, 212, 191, 0.3);
      padding: 1.5rem 0;
      text-align: center;
    }

    .footer-text {
      color: var(--muted);
      font-size: 0.9rem;
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
    @media (max-width: 768px) {
      .main-content {
        padding: 1rem 0 2rem;
      }
      
      .welcome-screen,
      .results-screen {
        padding: 1.5rem;
      }
      
      .btn {
        padding: 0.8rem 1.5rem;
        font-size: 1rem;
      }
      
      .progress-panel {
        padding: 1rem;
      }
      
      .results-groups {
        grid-template-columns: 1fr;
      }
      
      .story-container {
        padding: 1.5rem;
      }
    }

    @media (max-width: 480px) {
      .title {
        font-size: 1.8rem;
      }
      
      .subtitle {
        font-size: 1rem;
      }
      
      .btn-group {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
      
      .header-content {
        justify-content: center;
      }
      
      .phase-badge, .counter {
        font-size: 0.8rem;
        padding: 0.4rem 0.8rem;
      }
    }

    /* –ê–Ω–∏–º–∞—Ü–∏—è —É—Å–ø–µ—Ö–∞ */
    @keyframes success {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .success-animation {
      animation: success 0.5s ease;
    }
  </style>
</head>
<body>
  <!-- –ù–æ–≤–æ–≥–æ–¥–Ω–∏–µ –æ–≥–æ–Ω—å–∫–∏ -->
  <div class="lights"></div>
  
  <!-- –°–Ω–µ–∂–∏–Ω–∫–∏ -->
  <div id="snowflakes"></div>

  <div class="app">
    <!-- –®–∞–ø–∫–∞ -->
    <header class="header">
      <div class="container">
        <div class="header-content">
          <div class="logo">
            <span class="logo-icon">üéÑ</span>
            <span>–ù–æ–≤–æ–≥–æ–¥–Ω–∏–π —Ç–µ—Å—Ç –õ—é—à–µ—Ä–∞ 2026</span>
          </div>
          <div class="phase-indicator" id="phase-indicator"></div>
        </div>
      </div>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="main-content">
      <div class="container">
        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è -->
        <section class="screen active" id="screen-welcome">
          <div class="card welcome-screen">
            <h1 class="title">–û—Ç–∫—Ä–æ–π—Ç–µ —Å–≤–æ—é –Ω–æ–≤–æ–≥–æ–¥–Ω—é—é –∏—Å—Ç–æ—Ä–∏—é</h1>
            <div class="year-2026">2026</div>
            <p class="subtitle">
              –ü—Ä–æ–π–¥–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ–π —Ü–≤–µ—Ç–æ–≤–æ–π —Ç–µ—Å—Ç –∏ –ø–æ–ª—É—á–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ, 
              –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞ –≤–∞—à–µ–º –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø—Ä–æ—Ñ–∏–ª–µ
            </p>
            
            <div class="instructions">
              <div class="instructions-title">
                <span>üìã</span>
                <span>–ö–∞–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–µ—Å—Ç?</span>
              </div>
              
              <div class="steps">
                <div class="step">
                  <div class="step-content">
                    <div class="step-title">–ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä</div>
                    <div class="step-desc">–í—ã–±–∏—Ä–∞–π—Ç–µ —Ü–≤–µ—Ç–∞ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ, –Ω–µ –∑–∞–¥—É–º—ã–≤–∞—è—Å—å. –ü–µ—Ä–≤–∞—è —Ä–µ–∞–∫—Ü–∏—è ‚Äî —Å–∞–º–∞—è —á–µ—Å—Ç–Ω–∞—è.</div>
                  </div>
                </div>
                
                <div class="step">
                  <div class="step-content">
                    <div class="step-title">–í—ã–±—Ä–∞–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ –ø—Ä–æ–ø–∞–¥–∞—é—Ç</div>
                    <div class="step-desc">–ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Ü–≤–µ—Ç –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ ‚Äî —Ç–∞–∫ –≤—ã –≤–∏–¥–∏—Ç–µ —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å.</div>
                  </div>
                </div>
                
                <div class="step">
                  <div class="step-content">
                    <div class="step-title">–î–≤–∞ –∫—Ä—É–≥–∞ –≤—ã–±–æ—Ä–∞</div>
                    <div class="step-desc">–ü–µ—Ä–≤—ã–π –∫—Ä—É–≥: —Ä–∞—Å—Å—Ç–∞–≤—å—Ç–µ –≤—Å–µ —Ü–≤–µ—Ç–∞ –ø–æ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è–º. –í—Ç–æ—Ä–æ–π –∫—Ä—É–≥: –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤—ã–±–æ—Ä.</div>
                  </div>
                </div>
                
                <div class="step">
                  <div class="step-content">
                    <div class="step-title">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è 2026</div>
                    <div class="step-desc">–ù–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–∏—Ö –≤—ã–±–æ—Ä–æ–≤ —Å–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞—Å—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é –Ω–æ–≤–æ–≥–æ–¥–Ω—é—é –∏—Å—Ç–æ—Ä–∏—é –¥–ª—è 2026 –≥–æ–¥–∞.</div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="btn-group">
              <button class="btn btn-primary" id="btn-start">
                <span>üéÑ</span>
                <span>–ù–∞—á–∞—Ç—å –Ω–æ–≤–æ–≥–æ–¥–Ω–∏–π —Ç–µ—Å—Ç</span>
              </button>
            </div>
            
            <div class="hint">
              üí° –í—ã–±–∏—Ä–∞–π—Ç–µ –±—ã—Å—Ç—Ä–æ! –¶–≤–µ—Ç–∞ –±—É–¥—É—Ç –∏—Å—á–µ–∑–∞—Ç—å –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞. –ü–µ—Ä–≤–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —Ü–≤–µ—Ç ‚Äî —Å–∞–º–∞—è —Ç–æ—á–Ω–∞—è.
            </div>
          </div>
        </section>

        <!-- –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —Ü–≤–µ—Ç–æ–≤ -->
        <section class="screen" id="screen-colors">
          <div class="card">
            <div class="progress-panel">
              <div class="progress-header">
                <div class="phase-badge" id="phase-badge">
                  <span id="phase-icon">üîÑ</span>
                  <span id="phase-text">–ö—Ä—É–≥ 1 –∏–∑ 2</span>
                </div>
                <div class="counter" id="counter">0 –∏–∑ 8</div>
              </div>
              
              <div class="progress-container">
                <div class="progress-label">
                  <span>–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                  <span id="progress-percent">0%</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" id="progress-fill"></div>
                </div>
              </div>
              
              <div class="hint" id="selection-hint">
                üé® <strong>–ö—Ä—É–≥ 1:</strong> –í—ã–±–∏—Ä–∞–π—Ç–µ —Ü–≤–µ—Ç–∞ –æ—Ç —Å–∞–º–æ–≥–æ –ø—Ä–∏—è—Ç–Ω–æ–≥–æ –∫ –Ω–∞–∏–º–µ–Ω–µ–µ –ø—Ä–∏—è—Ç–Ω–æ–º—É. –í—ã–±—Ä–∞–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ –±—É–¥—É—Ç –∏—Å—á–µ–∑–∞—Ç—å.
              </div>
            </div>
            
            <div class="colors-grid" id="colors-grid">
              <!-- –¶–≤–µ—Ç–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
          </div>
        </section>

        <!-- –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
        <section class="screen" id="screen-results">
          <div class="card results-screen">
            <div class="results-header">
              <h2 class="results-title">
                <span>üéÅ</span>
                <span>–í–∞—à–∞ –Ω–æ–≤–æ–≥–æ–¥–Ω—è—è –∏—Å—Ç–æ—Ä–∏—è 2026 –≥–æ—Ç–æ–≤–∞!</span>
              </h2>
              <p class="results-subtitle">
                –ù–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–∏—Ö —Ü–≤–µ—Ç–æ–≤—ã—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π —Å–æ–∑–¥–∞–Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –∏ –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–µ –ø–æ–∂–µ–ª–∞–Ω–∏–µ –Ω–∞ 2026 –≥–æ–¥
              </p>
            </div>
            
            <div class="results-groups" id="results-groups">
              <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
            
            <div class="story-container">
              <div class="story-title">
                <span>üìñ</span>
                <span>–í–∞—à–∞ –Ω–æ–≤–æ–≥–æ–¥–Ω—è—è –∏—Å—Ç–æ—Ä–∏—è 2026</span>
              </div>
              <div class="story-content" id="story-content">
                –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∞—à–µ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏...
              </div>
              <div class="new-year-wish" id="new-year-wish">
                –° –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–º –ù–æ–≤—ã–º 2026 –ì–æ–¥–æ–º! üéÑ
              </div>
            </div>
            
            <div class="results-output">
              <textarea 
                class="results-textarea" 
                id="results-output" 
                readonly
                placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –≤–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã..."
              ></textarea>
            </div>
            
            <div class="btn-group">
              <button class="btn btn-primary" id="btn-restart">
                <span>üîÑ</span>
                <span>–ü—Ä–æ–π—Ç–∏ –µ—â—ë —Ä–∞–∑</span>
              </button>
              <button class="btn btn-secondary" id="btn-share">
                <span>üì§</span>
                <span>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</span>
              </button>
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- –ü–æ–¥–≤–∞–ª -->
    <footer class="footer">
      <div class="container">
        <p class="footer-text">
          ‚ú® –° –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–º –ù–æ–≤—ã–º 2026 –ì–æ–¥–æ–º! –ü—É—Å—Ç—å –æ–Ω –ø—Ä–∏–Ω–µ—Å—ë—Ç –≤–∞–º —Å—á–∞—Å—Ç—å–µ, –≥–∞—Ä–º–æ–Ω–∏—é –∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –∂–µ–ª–∞–Ω–∏–π!
        </p>
      </div>
    </footer>
  </div>

  <script>
    // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp ---
    const tg = window.Telegram?.WebApp;
    if (tg) {
      try {
        tg.ready();
        tg.expand();
        tg.setHeaderColor('#0c1b2c');
        tg.setBackgroundColor('#0c1b2c');
      } catch (e) {
        console.log('Telegram WebApp –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ');
      }
    }

    // --- –°–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–µ–∂–∏–Ω–æ–∫ ---
    function createSnowflakes() {
      const container = document.getElementById('snowflakes');
      container.innerHTML = '';
      for (let i = 0; i < 30; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        const size = Math.random() * 5 + 2;
        snowflake.style.width = `${size}px`;
        snowflake.style.height = `${size}px`;
        snowflake.style.left = `${Math.random() * 100}vw`;
        snowflake.style.animationDuration = `${Math.random() * 3 + 2}s`;
        snowflake.style.animationDelay = `${Math.random() * 2}s`;
        snowflake.style.opacity = Math.random() * 0.5 + 0.3;
        container.appendChild(snowflake);
      }
    }

    // --- –ü–∞–ª–∏—Ç—Ä–∞ —Ü–≤–µ—Ç–æ–≤ –õ—é—à–µ—Ä–∞ ---
    const COLORS = [
      { 
        id: 0, 
        name: '–°–µ—Ä—ã–π', 
        emoji: 'ü©∂', 
        hex: '#9aa0a6', 
        meaning: '–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å, —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ, –±–∞–ª–∞–Ω—Å',
        desc: '–°—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ –≥–∞—Ä–º–æ–Ω–∏–∏ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏'
      },
      { 
        id: 1, 
        name: '–°–∏–Ω–∏–π', 
        emoji: 'üîµ', 
        hex: '#1a73e8', 
        meaning: '–ì–∞—Ä–º–æ–Ω–∏—è, —É–º–∏—Ä–æ—Ç–≤–æ—Ä–µ–Ω–∏–µ, –¥–æ–≤–µ—Ä–∏–µ',
        desc: '–ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ –ø–æ–∫–æ–µ –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏'
      },
      { 
        id: 2, 
        name: '–ó–µ–ª—ë–Ω—ã–π', 
        emoji: 'üü¢', 
        hex: '#34a853', 
        meaning: '–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –Ω–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, —Å–∞–º–æ—É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ',
        desc: '–°—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ –ø—Ä–∏–∑–Ω–∞–Ω–∏—é –∏ –∫–æ–Ω—Ç—Ä–æ–ª—é'
      },
      { 
        id: 3, 
        name: '–ö—Ä–∞—Å–Ω—ã–π', 
        emoji: 'üî¥', 
        hex: '#ea4335', 
        meaning: '–≠–Ω–µ—Ä–≥–∏—è, –¥–µ–π—Å—Ç–≤–∏–µ, —Å—Ç—Ä–∞—Å—Ç—å',
        desc: '–ñ–µ–ª–∞–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏'
      },
      { 
        id: 4, 
        name: '–ñ—ë–ª—Ç—ã–π', 
        emoji: 'üü°', 
        hex: '#fbbc04', 
        meaning: '–ù–∞–¥–µ–∂–¥–∞, –æ–ø—Ç–∏–º–∏–∑–º, —Ä–∞–¥–æ—Å—Ç—å',
        desc: '–°—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ —Å–≤–æ–±–æ–¥–µ –∏ –Ω–æ–≤—ã–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º'
      },
      { 
        id: 5, 
        name: '–§–∏–æ–ª–µ—Ç–æ–≤—ã–π', 
        emoji: 'üü£', 
        hex: '#8e24aa', 
        meaning: '–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ, –∏–Ω—Ç—É–∏—Ü–∏—è, –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å',
        desc: '–ñ–µ–ª–∞–Ω–∏–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π –∏ —Å–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏—è'
      },
      { 
        id: 6, 
        name: '–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π', 
        emoji: 'üü§', 
        hex: '#8d6e63', 
        meaning: '–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –∫–æ–º—Ñ–æ—Ä—Ç',
        desc: '–ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º —É–¥–æ–±—Å—Ç–≤–µ'
      },
      { 
        id: 7, 
        name: '–ß—ë—Ä–Ω—ã–π', 
        emoji: '‚ö´', 
        hex: '#202124', 
        meaning: '–ü—Ä–æ—Ç–µ—Å—Ç, –≥—Ä–∞–Ω–∏—Ü—ã, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å',
        desc: '–ñ–µ–ª–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω –∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è'
      }
    ];

    // --- –≠–ª–µ–º–µ–Ω—Ç—ã DOM ---
    const elements = {
      screens: {
        welcome: document.getElementById('screen-welcome'),
        colors: document.getElementById('screen-colors'),
        results: document.getElementById('screen-results')
      },
      buttons: {
        start: document.getElementById('btn-start'),
        restart: document.getElementById('btn-restart'),
        share: document.getElementById('btn-share')
      },
      progress: {
        phaseBadge: document.getElementById('phase-badge'),
        phaseIcon: document.getElementById('phase-icon'),
        phaseText: document.getElementById('phase-text'),
        counter: document.getElementById('counter'),
        progressFill: document.getElementById('progress-fill'),
        progressPercent: document.getElementById('progress-percent')
      },
      grid: document.getElementById('colors-grid'),
      results: {
        groups: document.getElementById('results-groups'),
        story: document.getElementById('story-content'),
        wish: document.getElementById('new-year-wish'),
        output: document.getElementById('results-output')
      }
    };

    // --- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ---
    let state = {
      phase: 1, // 1 –∏–ª–∏ 2
      picks: {
        first: [],
        second: []
      }
    };

    // --- –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞–º–∏ ---
    function showScreen(screenName) {
      // –°–∫—Ä—ã—Ç—å –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
      Object.values(elements.screens).forEach(screen => {
        screen.classList.remove('active');
      });
      
      // –ü–æ–∫–∞–∑–∞—Ç—å –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω
      elements.screens[screenName].classList.add('active');
      
      // –ï—Å–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —ç–∫—Ä–∞–Ω —Ü–≤–µ—Ç–æ–≤, –¥–æ–±–∞–≤–ª—è–µ–º —Å–Ω–µ–∂–∏–Ω–∫–∏
      if (screenName === 'colors') {
        createSnowflakes();
      }
    }

    // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞ ---
    function startTest() {
      state = {
        phase: 1,
        picks: { first: [], second: [] }
      };
      
      updateProgress();
      renderColors();
      showScreen('colors');
    }

    // --- –†–µ–Ω–¥–µ—Ä —Ü–≤–µ—Ç–æ–≤ ---
    function renderColors() {
      elements.grid.innerHTML = '';
      
      // –ü–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ü–≤–µ—Ç–∞ (—Ç–µ, —á—Ç–æ –µ—â—ë –Ω–µ –≤—ã–±—Ä–∞–Ω—ã –≤ —Ç–µ–∫—É—â–µ–º –∫—Ä—É–≥–µ)
      const availableColors = getAvailableColors();
      
      if (availableColors.length === 0) {
        // –í—Å–µ —Ü–≤–µ—Ç–∞ –≤—ã–±—Ä–∞–Ω—ã, –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∫—Ä—É–≥—É –∏–ª–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
        if (state.phase === 1) {
          state.phase = 2;
          updateProgress();
          renderColors();
        } else {
          finishTest();
        }
        return;
      }
      
      // –°–æ—Ä—Ç–∏—Ä—É–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ü–≤–µ—Ç–∞ –ø–æ –∏—Ö ID –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
      availableColors.sort((a, b) => a.id - b.id).forEach(color => {
        const colorCard = document.createElement('div');
        colorCard.className = 'color-card';
        colorCard.style.background = color.hex;
        colorCard.dataset.id = color.id;
        colorCard.dataset.name = color.name;
        
        colorCard.onclick = () => selectColor(color.id, colorCard);
        
        // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ü–≤–µ—Ç–µ
        const colorInfo = document.createElement('div');
        colorInfo.className = 'color-info';
        colorInfo.innerHTML = `
          <div class="color-name">${color.emoji} ${color.name}</div>
          <div class="color-desc">${color.meaning}</div>
        `;
        colorCard.appendChild(colorInfo);
        
        elements.grid.appendChild(colorCard);
      });
    }

    // --- –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤ ---
    function getAvailableColors() {
      const currentPicks = state.phase === 1 ? state.picks.first : state.picks.second;
      return COLORS.filter(color => !currentPicks.includes(color.id));
    }

    // --- –í—ã–±–æ—Ä —Ü–≤–µ—Ç–∞ ---
    function selectColor(colorId, element) {
      const currentPicks = state.phase === 1 ? state.picks.first : state.picks.second;
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤—ã–±—Ä–∞–Ω –ª–∏ —É–∂–µ —Ü–≤–µ—Ç
      if (currentPicks.includes(colorId)) return;
      
      // –î–æ–±–∞–≤–ª—è–µ–º –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ
      currentPicks.push(colorId);
      
      // –í–∏–∑—É–∞–ª—å–Ω–æ –æ—Ç–º–µ—á–∞–µ–º –≤—ã–±–æ—Ä
      element.classList.add('selected');
      element.style.pointerEvents = 'none';
      
      // –î–æ–±–∞–≤–ª—è–µ–º –±–µ–π–¥–∂ –≤—ã–±–æ—Ä–∞
      const badge = document.createElement('div');
      badge.className = 'selected-badge';
      badge.innerHTML = '‚úì';
      element.appendChild(badge);
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
      updateProgress();
      
      // –ß–µ—Ä–µ–∑ –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –æ–±–Ω–æ–≤–ª—è–µ–º —Å–µ—Ç–∫—É (—Ü–≤–µ—Ç –∏—Å—á–µ–∑–Ω–µ—Ç)
      setTimeout(() => {
        renderColors();
      }, 500);
    }

    // --- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ ---
    function updateProgress() {
      const currentPicks = state.phase === 1 ? state.picks.first : state.picks.second;
      const progress = (currentPicks.length / COLORS.length) * 100;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
      elements.progress.phaseText.textContent = `–ö—Ä—É–≥ ${state.phase} –∏–∑ 2`;
      elements.progress.phaseIcon.textContent = state.phase === 1 ? 'üîÑ' : 'üéØ';
      elements.progress.counter.textContent = `${currentPicks.length} –∏–∑ ${COLORS.length}`;
      elements.progress.progressPercent.textContent = `${Math.round(progress)}%`;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
      elements.progress.progressFill.style.width = `${progress}%`;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
      const hint = document.getElementById('selection-hint');
      if (hint) {
        if (state.phase === 1) {
          hint.innerHTML = 'üé® <strong>–ö—Ä—É–≥ 1:</strong> –í—ã–±–∏—Ä–∞–π—Ç–µ —Ü–≤–µ—Ç–∞ –æ—Ç —Å–∞–º–æ–≥–æ –ø—Ä–∏—è—Ç–Ω–æ–≥–æ –∫ –Ω–∞–∏–º–µ–Ω–µ–µ –ø—Ä–∏—è—Ç–Ω–æ–º—É. –í—ã–±—Ä–∞–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ –±—É–¥—É—Ç –∏—Å—á–µ–∑–∞—Ç—å.';
        } else {
          hint.innerHTML = 'üéØ <strong>–ö—Ä—É–≥ 2:</strong> –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤—ã–±–æ—Ä –µ—â—ë —Ä–∞–∑, —Å–ª–µ–¥—É—è —Å–≤–æ–µ–π –∏–Ω—Ç—É–∏—Ü–∏–∏. –¶–≤–µ—Ç–∞ —Å–Ω–æ–≤–∞ –∏—Å—á–µ–∑–∞—é—Ç –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞.';
        }
      }
    }

    // --- –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ---
    function analyzeResults() {
      const positions = {};
      state.picks.second.forEach((colorId, index) => {
        positions[colorId] = index;
      });
      
      // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Ü–≤–µ—Ç–∞ –ø–æ –ø–æ–∑–∏—Ü–∏—è–º
      const groups = {
        favorite: [],   // –ü–æ–∑–∏—Ü–∏–∏ 0-1
        liked: [],      // –ü–æ–∑–∏—Ü–∏–∏ 2-3
        neutral: [],    // –ü–æ–∑–∏—Ü–∏–∏ 4-5
        disliked: []    // –ü–æ–∑–∏—Ü–∏–∏ 6-7
      };
      
      COLORS.forEach(color => {
        const position = positions[color.id];
        if (position <= 1) groups.favorite.push(color);
        else if (position <= 3) groups.liked.push(color);
        else if (position <= 5) groups.neutral.push(color);
        else groups.disliked.push(color);
      });
      
      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
      const characteristics = [];
      
      if (groups.favorite.some(c => c.id === 1)) {
        characteristics.push('–í–∞–º –≤–∞–∂–Ω—ã –≥–∞—Ä–º–æ–Ω–∏—è –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å');
      }
      if (groups.favorite.some(c => c.id === 3)) {
        characteristics.push('–í—ã –ø–æ–ª–Ω—ã —ç–Ω–µ—Ä–≥–∏–∏ –∏ —Å—Ç—Ä–µ–º–∏—Ç–µ—Å—å –∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º');
      }
      if (groups.favorite.some(c => c.id === 4)) {
        characteristics.push('–û–ø—Ç–∏–º–∏–∑–º –∏ –Ω–∞–¥–µ–∂–¥–∞ –≤–µ–¥—É—Ç –≤–∞—Å –≤–ø–µ—Ä–µ–¥');
      }
      if (groups.favorite.some(c => c.id === 2)) {
        characteristics.push('–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Å–µ–±–µ –∏ —Å—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ –∫–æ–Ω—Ç—Ä–æ–ª—é');
      }
      if (groups.disliked.some(c => c.id === 1)) {
        characteristics.push('–í–æ–∑–º–æ–∂–Ω–æ, –≤—ã –∏—â–µ—Ç–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω—ã');
      }
      if (groups.disliked.some(c => c.id === 2)) {
        characteristics.push('–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Å–≤–æ–∏—Ö —Å–∏–ª–∞—Ö');
      }
      if (groups.favorite.some(c => c.id === 7)) {
        characteristics.push('–ñ–µ–ª–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü');
      }
      
      return { positions, groups, characteristics };
    }

    // --- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–π –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è 2026 –≥–æ–¥–∞ ---
    function generateNewYearStory(analysis) {
      const topColors = analysis.groups.favorite.slice(0, 2);
      const stories = [];
      
      // –û—Å–Ω–æ–≤–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–æ–ø-—Ü–≤–µ—Ç–æ–≤
      if (topColors.some(c => c.id === 1)) { // –°–∏–Ω–∏–π
        stories.push(
          "–í—Å—Ç—Ä–µ—á–∞—è 2026 –≥–æ–¥, –≤—ã –æ–±—Ä–µ—Ç—ë—Ç–µ –¥–æ–ª–≥–æ–∂–¥–∞–Ω–Ω—ã–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ–∫–æ–π. –ö–∞–∫ —Ç–∏—Ö–∏–π –∑–∏–º–Ω–∏–π –≤–µ—á–µ—Ä –ø–æ—Å–ª–µ –º–µ—Ç–µ–ª–∏, –Ω–æ–≤—ã–π –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å—ë—Ç –≤–∞–º –≥–∞—Ä–º–æ–Ω–∏—é –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ. –í–∞–º –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –º—É–¥—Ä–æ—Å—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏—è, —á—Ç–æ —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ —É–∂–µ —Ä—è–¥–æ–º ‚Äî –≤ –ø—Ä–æ—Å—Ç—ã—Ö –º–æ–º–µ–Ω—Ç–∞—Ö –∏ –∏—Å–∫—Ä–µ–Ω–Ω–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö."
        );
      }
      
      if (topColors.some(c => c.id === 3)) { // –ö—Ä–∞—Å–Ω—ã–π
        stories.push(
          "2026 –≥–æ–¥ –¥–ª—è –≤–∞—Å ‚Äî –∫–∞–∫ —è—Ä–∫–∏–π –Ω–æ–≤–æ–≥–æ–¥–Ω–∏–π —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫! –≠–Ω–µ—Ä–≥–∏—è –∏ —Å—Ç—Ä–∞—Å—Ç—å –ø–æ–≤–µ–¥—É—Ç –≤–∞—Å –∫ –Ω–æ–≤—ã–º –≤–µ—Ä—à–∏–Ω–∞–º. –ù–µ –±–æ–π—Ç–µ—Å—å —Å–º–µ–ª—ã—Ö —Ä–µ—à–µ–Ω–∏–π ‚Äî –≤—Å–µ–ª–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∏—Ç –≤–∞—à–∏ –Ω–∞—á–∏–Ω–∞–Ω–∏—è, –∞ —É–¥–∞—á–∞ —Å—Ç–∞–Ω–µ—Ç –≤–∞—à–∏–º –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º —Å–ø—É—Ç–Ω–∏–∫–æ–º. –≠—Ç–æ—Ç –≥–æ–¥ —Å—Ç–∞–Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–µ–º –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏ –≤–ø–µ—á–∞—Ç–ª—è—é—â–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤."
        );
      }
      
      if (topColors.some(c => c.id === 4)) { // –ñ—ë–ª—Ç—ã–π
        stories.push(
          "–°–æ–ª–Ω–µ—á–Ω—ã–π –æ–ø—Ç–∏–º–∏–∑–º, –∫–∞–∫ –∂—ë–ª—Ç—ã–µ –æ–≥–æ–Ω—å–∫–∏ –≥–∏—Ä–ª—è–Ω–¥, –æ—Å–≤–µ—Ç–∏—Ç –≤–∞—à –ø—É—Ç—å –≤ 2026 –≥–æ–¥—É. –í—ã —É–≤–∏–¥–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ç–∞–º, –≥–¥–µ –¥—Ä—É–≥–∏–µ –≤–∏–¥—è—Ç –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è. –í–∞—à–∞ –Ω–∞–¥–µ–∂–¥–∞ –∏ –≤–µ—Ä–∞ –≤ –ª—É—á—à–µ–µ —Å—Ç–∞–Ω—É—Ç —Å–∞–º—ã–º —Ü–µ–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º –∏ –ø—Ä–∏—è—Ç–Ω—ã–º –æ—Ç–∫—Ä—ã—Ç–∏—è–º."
        );
      }
      
      if (topColors.some(c => c.id === 2)) { // –ó–µ–ª—ë–Ω—ã–π
        stories.push(
          "–ö–∞–∫ –≤–µ—á–Ω–æ–∑–µ–ª—ë–Ω–∞—è –Ω–æ–≤–æ–≥–æ–¥–Ω—è—è –µ–ª—å, –≤—ã —Å—Ç–æ–∏—Ç–µ —Ç–≤—ë—Ä–¥–æ –Ω–∞ —Å–≤–æ–∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö. 2026 –≥–æ–¥ —É–∫—Ä–µ–ø–∏—Ç –≤–∞—à—É —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø—Ä–∏–Ω–µ—Å—ë—Ç –∑–∞—Å–ª—É–∂–µ–Ω–Ω–æ–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ. –í–∞—à–µ —É–ø–æ—Ä—Å—Ç–≤–æ –∏ –Ω–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø—Ä–µ–≤—Ä–∞—Ç—è—Ç –¥–∞–∂–µ —Å–∞–º—ã–µ —Å–º–µ–ª—ã–µ –º–µ—á—Ç—ã –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä—É—é –≤—ã —Å–º–æ–∂–µ—Ç–µ –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –æ—Ü–µ–Ω–∏—Ç—å."
        );
      }
      
      // –ï—Å–ª–∏ –Ω–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Ü–≤–µ—Ç–æ–≤, –æ–±—â–∞—è –∏—Å—Ç–æ—Ä–∏—è
      if (stories.length === 0) {
        stories.push(
          "2026 –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å—ë—Ç –≤–∞–º –±–∞–ª–∞–Ω—Å –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤–æ –≤—Å–µ—Ö —Å—Ñ–µ—Ä–∞—Ö –∂–∏–∑–Ω–∏. –ö–∞–∫ –∏–¥–µ–∞–ª—å–Ω–æ —É–∫—Ä–∞—à–µ–Ω–Ω–∞—è –Ω–æ–≤–æ–≥–æ–¥–Ω—è—è —ë–ª–∫–∞, –≤–∞—à–∞ –∂–∏–∑–Ω—å –æ–±—Ä–µ—Ç—ë—Ç –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã, –æ—Ç–¥—ã—Ö–∞ –∏ –ª–∏—á–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è. –í—ã –Ω–∞—É—á–∏—Ç–µ—Å—å —Ü–µ–Ω–∏—Ç—å –º–æ–º–µ–Ω—Ç—ã –ø–æ–∫–æ—è –∏ –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –≤ –Ω—É–∂–Ω–æ–µ –≤—Ä–µ–º—è."
        );
      }
      
      // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ —á–µ—Ä–Ω—ã–π –∏ —Å–µ—Ä—ã–π
      if (topColors.some(c => c.id === 7)) { // –ß—ë—Ä–Ω—ã–π
        stories.push("2026 –≥–æ–¥ —Å—Ç–∞–Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–µ–º –≤–∞–∂–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω –∏ –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π.");
      }
      if (topColors.some(c => c.id === 0)) { // –°–µ—Ä—ã–π
        stories.push("–í—ã –Ω–∞–π–¥—ë—Ç–µ –∏–¥–µ–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏ –æ—Ç–¥—ã—Ö–æ–º.");
      }
      
      // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–∂–µ–ª–∞–Ω–∏—è –Ω–∞ 2026 –≥–æ–¥
      const wishes = [
        "–ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å 2026 –≥–æ–¥–∞ –±—É–¥–µ—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω —Ä–∞–¥–æ—Å—Ç—å—é, –∞ –∫–∞–∂–¥–æ–µ –Ω–∞—á–∏–Ω–∞–Ω–∏–µ ‚Äî —É—Å–ø–µ—Ö–æ–º!",
        "–ñ–µ–ª–∞–µ–º, —á—Ç–æ–±—ã 2026 –≥–æ–¥ –ø—Ä–∏–Ω—ë—Å –≤–∞–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∞–º—ã—Ö —Å–æ–∫—Ä–æ–≤–µ–Ω–Ω—ã—Ö –∂–µ–ª–∞–Ω–∏–π –∏ —Å–≤–µ—Ç–ª—ã—Ö –Ω–∞–¥–µ–∂–¥!",
        "–ü—É—Å—Ç—å 2026 –≥–æ–¥ –±—É–¥–µ—Ç —Å–≤–µ—Ç–ª—ã–º, –∫–∞–∫ –Ω–æ–≤–æ–≥–æ–¥–Ω–∏–µ –≥–∏—Ä–ª—è–Ω–¥—ã, –∏ —Ç—ë–ø–ª—ã–º, –∫–∞–∫ —Å–µ–º–µ–π–Ω—ã–π —É—é—Ç!",
        "–ñ–µ–ª–∞–µ–º –∑–¥–æ—Ä–æ–≤—å—è, –ª—é–±–≤–∏, –ø—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏—è –∏ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç–∫—Ä—ã—Ç–∏–π –≤ 2026 –≥–æ–¥—É!"
      ];
      
      return {
        story: stories.join(' '),
        wish: wishes[Math.floor(Math.random() * wishes.length)]
      };
    }

    // --- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞ ---
    function finishTest() {
      const analysis = analyzeResults();
      const story = generateNewYearStory(analysis);
      
      // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram
      if (tg) {
        const payload = {
          type: 'new_year_luscher_2026',
          phase: 'completed',
          picks: state.picks,
          analysis: analysis,
          story: story,
          timestamp: new Date().toISOString()
        };
        
        try {
          tg.sendData(JSON.stringify(payload));
        } catch (e) {
          console.log('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ');
        }
      }
      
      // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
      displayResults(analysis, story);
      showScreen('results');
      
      // –î–æ–±–∞–≤–ª—è–µ–º —Å–Ω–µ–∂–∏–Ω–∫–∏ –Ω–∞ —ç–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
      createSnowflakes();
    }

    // --- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ---
    function displayResults(analysis, story) {
      const groups = analysis.groups;
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≥—Ä—É–ø–ø—ã —Ü–≤–µ—Ç–æ–≤
      elements.results.groups.innerHTML = `
        <div class="result-group">
          <div class="group-header">
            <span>‚ù§Ô∏è</span>
            <span>–õ—é–±–∏–º—ã–µ —Ü–≤–µ—Ç–∞</span>
          </div>
          <div class="group-content">
            ${groups.favorite.map(color => `
              <div class="color-tag" style="border-left: 4px solid ${color.hex}">
                ${color.emoji} ${color.name}
              </div>
            `).join('')}
          </div>
        </div>
        
        <div class="result-group">
          <div class="group-header">
            <span>‚ú®</span>
            <span>–ü—Ä–∏—è—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞</span>
          </div>
          <div class="group-content">
            ${groups.liked.map(color => `
              <div class="color-tag" style="border-left: 4px solid ${color.hex}">
                ${color.emoji} ${color.name}
              </div>
            `).join('')}
          </div>
        </div>
        
        <div class="result-group">
          <div class="group-header">
            <span>‚öñÔ∏è</span>
            <span>–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ —Ü–≤–µ—Ç–∞</span>
          </div>
          <div class="group-content">
            ${groups.neutral.map(color => `
              <div class="color-tag" style="border-left: 4px solid ${color.hex}">
                ${color.emoji} ${color.name}
              </div>
            `).join('')}
          </div>
        </div>
        
        <div class="result-group">
          <div class="group-header">
            <span>üåô</span>
            <span>–ù–µ–ø—Ä–∏—è—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞</span>
          </div>
          <div class="group-content">
            ${groups.disliked.map(color => `
              <div class="color-tag" style="border-left: 4px solid ${color.hex}">
                ${color.emoji} ${color.name}
              </div>
            `).join('')}
          </div>
        </div>
      `;
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é
      elements.results.story.textContent = story.story;
      elements.results.wish.textContent = story.wish + " üéÜ 2026";
      
      // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–π –≤—ã–≤–æ–¥
      const output = {
        '–ù–æ–≤–æ–≥–æ–¥–Ω–∏–π —Ç–µ—Å—Ç –õ—é—à–µ—Ä–∞ 2026': '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã',
        '–î–∞—Ç–∞ —Ç–µ—Å—Ç–∞': new Date().toLocaleDateString('ru-RU', {
          year: 'numeric',
          month: 'long',
          day: 'numeric',
          hour: '2-digit',
          minute: '2-digit'
        }),
        '–õ—é–±–∏–º—ã–µ —Ü–≤–µ—Ç–∞': groups.favorite.map(c => `${c.emoji} ${c.name}`).join(', '),
        '–ü—Ä–∏—è—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞': groups.liked.map(c => `${c.emoji} ${c.name}`).join(', '),
        '–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ —Ü–≤–µ—Ç–∞': groups.neutral.map(c => `${c.emoji} ${c.name}`).join(', '),
        '–ù–µ–ø—Ä–∏—è—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞': groups.disliked.map(c => `${c.emoji} ${c.name}`).join(', '),
        '–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å–∞–π—Ç—ã': analysis.characteristics,
        '–í–∞—à–∞ –Ω–æ–≤–æ–≥–æ–¥–Ω—è—è –∏—Å—Ç–æ—Ä–∏—è 2026': story.story,
        '–ü–æ–∂–µ–ª–∞–Ω–∏–µ –Ω–∞ 2026 –≥–æ–¥': story.wish,
        '---': '–° –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–º –ù–æ–≤—ã–º 2026 –ì–æ–¥–æ–º! üéÑ‚ú®'
      };
      
      elements.results.output.value = Object.entries(output)
        .map(([key, value]) => `${key}:\n${value}\n`)
        .join('\n');
    }

    // --- –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ---
    function saveResults() {
      const text = elements.results.output.value;
      const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      
      const a = document.createElement('a');
      a.href = url;
      a.download = `–Ω–æ–≤–æ–≥–æ–¥–Ω–∏–π-—Ç–µ—Å—Ç-2026-${new Date().toISOString().split('T')[0]}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
      alert('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª! –ú–æ–∂–µ—Ç–µ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –∏–º–∏ —Å –¥—Ä—É–∑—å—è–º–∏. ‚ú®');
    }

    // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π ---
    function initEvents() {
      elements.buttons.start.addEventListener('click', startTest);
      elements.buttons.restart.addEventListener('click', () => {
        showScreen('welcome');
      });
      elements.buttons.share.addEventListener('click', saveResults);
      
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Å–∞–Ω–∏–π –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
      document.addEventListener('touchstart', function() {}, {passive: true});
    }

    // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ---
    function initApp() {
      createSnowflakes();
      initEvents();
      showScreen('welcome');
      
      // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
      function handleResize() {
        const vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
      }
      
      window.addEventListener('resize', handleResize);
      window.addEventListener('orientationchange', handleResize);
      handleResize();
      
      // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ
      console.log('‚ú® –° –ù–æ–≤—ã–º 2026 –ì–æ–¥–æ–º! –ü—É—Å—Ç—å –≤–∞—à —Ç–µ—Å—Ç –ø—Ä–∏–Ω–µ—Å—ë—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç–∏—è!');
    }

    // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initApp);
    } else {
      initApp();
    }
  </script>
</body>
</html>
