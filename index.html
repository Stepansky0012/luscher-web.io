<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>üéÑ –ù–æ–≤–æ–≥–æ–¥–Ω–∏–π —Ç–µ—Å—Ç –õ—é—à–µ—Ä–∞ 2026</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root {
      --bg: linear-gradient(135deg, #0c1b2c 0%, #1a2b3c 50%, #0f172a 100%);
      --panel: rgba(16, 36, 64, 0.95);
      --text: #f0f8ff;
      --muted: #b8d4ff;
      --primary: #2dd4bf;
      --secondary: #ff3366;
      --gold: #ffd700;
      --silver: #c0c0c0;
      --success: #34a853;
      --radius: 16px;
      --shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }

    html, body {
      height: 100%;
      overflow-x: hidden;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      line-height: 1.5;
      position: relative;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 16px;
      width: 100%;
    }

    /* –®–∞–ø–∫–∞ */
    .header {
      background: rgba(8, 28, 50, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 2px solid rgba(45, 212, 191, 0.3);
      padding: 12px 0;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      text-align: center;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      font-size: 1rem;
    }

    .logo-icon {
      font-size: 1.2rem;
    }

    /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
    .main-content {
      padding: 20px 0 40px;
      min-height: calc(100vh - 120px);
      display: flex;
      align-items: center;
    }

    .screen {
      display: none;
      width: 100%;
    }

    .screen.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* –ö–∞—Ä—Ç–æ—á–∫–∞ */
    .card {
      background: var(--panel);
      border: 2px solid rgba(45, 212, 191, 0.2);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow: hidden;
      max-width: 800px;
      margin: 0 auto;
    }

    /* –≠–∫—Ä–∞–Ω—ã */
    .welcome-screen {
      text-align: center;
      padding: 24px 16px;
    }

    .title {
      font-size: 1.8rem;
      margin-bottom: 12px;
      background: linear-gradient(135deg, var(--primary), var(--gold));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .year-2026 {
      color: var(--gold);
      font-size: 2.2rem;
      margin: 12px 0;
      text-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
    }

    @media (max-width: 480px) {
      .title {
        font-size: 1.5rem;
      }
      .year-2026 {
        font-size: 1.8rem;
      }
    }

    .subtitle {
      font-size: 1rem;
      color: var(--muted);
      margin-bottom: 20px;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }

    /* –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è */
    .instructions {
      background: rgba(12, 27, 44, 0.6);
      border: 1px solid rgba(45, 212, 191, 0.2);
      border-radius: 12px;
      padding: 16px;
      margin: 20px auto;
      max-width: 600px;
    }

    .instructions-title {
      color: var(--primary);
      font-size: 1.1rem;
      margin-bottom: 12px;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .steps {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .step {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 8px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
    }

    .step-icon {
      background: var(--primary);
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      font-weight: bold;
      font-size: 0.9rem;
    }

    .step-content {
      flex: 1;
    }

    .step-title {
      font-weight: 600;
      margin-bottom: 4px;
      color: var(--text);
      font-size: 0.95rem;
    }

    .step-desc {
      color: var(--muted);
      font-size: 0.85rem;
      line-height: 1.4;
    }

    /* –ü–∞–Ω–µ–ª—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
    .progress-panel {
      background: rgba(8, 28, 50, 0.9);
      padding: 16px;
      border-bottom: 2px solid rgba(45, 212, 191, 0.3);
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      flex-wrap: wrap;
      gap: 8px;
    }

    .phase-badge {
      background: linear-gradient(135deg, var(--primary), #22c55e);
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 0.85rem;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .counter {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text);
      padding: 6px 12px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 0.85rem;
    }

    .progress-container {
      margin: 12px 0;
    }

    .progress-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 6px;
      font-size: 0.85rem;
      color: var(--muted);
    }

    .progress-bar {
      height: 10px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 5px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      width: 0%;
      transition: width 0.3s ease;
    }

    /* –°–µ—Ç–∫–∞ —Ü–≤–µ—Ç–æ–≤ - –§–ò–ö–°–ò–†–û–í–ê–ù–ù–ê–Ø –†–ê–°–ö–õ–ê–î–ö–ê */
    .colors-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-template-rows: repeat(2, 1fr);
      gap: 12px;
      padding: 16px;
      min-height: 360px;
      height: 50vh;
      max-height: 400px;
    }

    @media (max-width: 480px) {
      .colors-grid {
        gap: 8px;
        padding: 12px;
        min-height: 300px;
        height: 45vh;
      }
    }

    .color-card {
      position: relative;
      border-radius: 12px;
      cursor: pointer;
      overflow: hidden;
      border: 2px solid transparent;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      transition: all 0.2s ease;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 12px;
      opacity: 1;
    }

    .color-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
    }

    .color-card.selected {
      opacity: 0.3;
      pointer-events: none;
      border-color: var(--success);
    }

    .color-card.selected::after {
      content: '‚úì';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: var(--success);
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      font-weight: bold;
      z-index: 2;
    }

    .color-info {
      position: relative;
      z-index: 1;
      pointer-events: none;
    }

    .color-name {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 2px;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    }

    .color-desc {
      font-size: 0.75rem;
      color: rgba(255, 255, 255, 0.9);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    }

    /* –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
    .results-screen {
      padding: 20px 16px;
    }

    .results-header {
      text-align: center;
      margin-bottom: 20px;
    }

    .results-title {
      font-size: 1.5rem;
      margin-bottom: 12px;
      color: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .results-subtitle {
      color: var(--muted);
      font-size: 0.95rem;
      max-width: 500px;
      margin: 0 auto 20px;
    }

    /* –ì—Ä—É–ø–ø—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
    .results-groups {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
      margin-bottom: 20px;
    }

    .result-group {
      background: rgba(12, 27, 44, 0.7);
      border-radius: 12px;
      padding: 16px;
      border: 1px solid rgba(45, 212, 191, 0.2);
    }

    .group-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
      color: var(--gold);
      font-size: 1rem;
      font-weight: 600;
    }

    .group-content {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .color-tag {
      background: rgba(255, 255, 255, 0.1);
      padding: 6px 10px;
      border-radius: 16px;
      font-size: 0.85rem;
    }

    /* –ù–æ–≤–æ–≥–æ–¥–Ω—è—è –∏—Å—Ç–æ—Ä–∏—è */
    .story-container {
      background: linear-gradient(135deg, rgba(45, 212, 191, 0.1), rgba(255, 51, 102, 0.1));
      border: 2px solid var(--gold);
      border-radius: 16px;
      padding: 20px;
      margin: 20px 0;
      position: relative;
    }

    .story-title {
      color: var(--gold);
      font-size: 1.2rem;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .story-content {
      font-size: 1rem;
      line-height: 1.6;
      color: var(--text);
      margin-bottom: 16px;
    }

    .new-year-wish {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(45, 212, 191, 0.15));
      border-left: 3px solid var(--gold);
      padding: 12px;
      border-radius: 8px;
      margin-top: 12px;
      font-style: italic;
      color: var(--muted);
    }

    /* –ö–Ω–æ–ø–∫–∏ */
    .btn {
      border: none;
      border-radius: 10px;
      padding: 12px 20px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary), #22c55e);
      color: white;
      box-shadow: 0 4px 12px rgba(45, 212, 191, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(45, 212, 191, 0.4);
    }

    .btn-secondary {
      background: rgba(255, 51, 102, 0.15);
      color: var(--secondary);
      border: 2px solid rgba(255, 51, 102, 0.3);
    }

    .btn-secondary:hover {
      background: rgba(255, 51, 102, 0.25);
      transform: translateY(-2px);
    }

    .btn-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 20px;
    }

    /* –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
    .results-output {
      margin-top: 20px;
    }

    .results-textarea {
      width: 100%;
      min-height: 150px;
      background: rgba(12, 27, 44, 0.8);
      color: var(--text);
      border: 2px solid rgba(45, 212, 191, 0.3);
      border-radius: 10px;
      padding: 12px;
      font-family: 'Courier New', monospace;
      font-size: 0.85rem;
      resize: vertical;
      line-height: 1.5;
    }

    .results-textarea:focus {
      outline: none;
      border-color: var(--primary);
    }

    /* –ü–æ–¥—Å–∫–∞–∑–∫–∞ */
    .hint {
      text-align: center;
      color: var(--muted);
      font-size: 0.85rem;
      margin-top: 12px;
      padding: 10px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* –ü–æ–¥–≤–∞–ª */
    .footer {
      background: rgba(8, 28, 50, 0.95);
      border-top: 2px solid rgba(45, 212, 191, 0.3);
      padding: 16px 0;
      text-align: center;
    }

    .footer-text {
      color: var(--muted);
      font-size: 0.85rem;
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
    @media (min-width: 481px) {
      .btn-group {
        flex-direction: row;
      }
      
      .btn {
        width: auto;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- –®–∞–ø–∫–∞ -->
    <header class="header">
      <div class="container">
        <div class="header-content">
          <div class="logo">
            <span class="logo-icon">üéÑ</span>
            <span>–ù–æ–≤–æ–≥–æ–¥–Ω–∏–π —Ç–µ—Å—Ç –õ—é—à–µ—Ä–∞ 2026</span>
          </div>
        </div>
      </div>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="main-content">
      <div class="container">
        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è -->
        <section class="screen active" id="screen-welcome">
          <div class="card welcome-screen">
            <h1 class="title">–û—Ç–∫—Ä–æ–π—Ç–µ —Å–≤–æ—é –Ω–æ–≤–æ–≥–æ–¥–Ω—é—é –∏—Å—Ç–æ—Ä–∏—é</h1>
            <div class="year-2026">2026</div>
            <p class="subtitle">
              –ü—Ä–æ–π–¥–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ–π —Ü–≤–µ—Ç–æ–≤–æ–π —Ç–µ—Å—Ç –∏ –ø–æ–ª—É—á–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ 2026 –≥–æ–¥
            </p>
            
            <div class="instructions">
              <div class="instructions-title">
                <span>üìã</span>
                <span>–ö–∞–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–µ—Å—Ç?</span>
              </div>
              
              <div class="steps">
                <div class="step">
                  <div class="step-icon">1</div>
                  <div class="step-content">
                    <div class="step-title">–ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä</div>
                    <div class="step-desc">–í—ã–±–∏—Ä–∞–π—Ç–µ —Ü–≤–µ—Ç–∞ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ, –Ω–µ –∑–∞–¥—É–º—ã–≤–∞—è—Å—å. –ü–µ—Ä–≤–∞—è —Ä–µ–∞–∫—Ü–∏—è ‚Äî —Å–∞–º–∞—è —á–µ—Å—Ç–Ω–∞—è.</div>
                  </div>
                </div>
                
                <div class="step">
                  <div class="step-icon">2</div>
                  <div class="step-content">
                    <div class="step-title">–í—Å–µ —Ü–≤–µ—Ç–∞ –≤–∏–¥–Ω—ã —Å—Ä–∞–∑—É</div>
                    <div class="step-desc">–í—Å–µ 8 —Ü–≤–µ—Ç–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –Ω–∞ —ç–∫—Ä–∞–Ω–µ. –í—ã–±—Ä–∞–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º–∏.</div>
                  </div>
                </div>
                
                <div class="step">
                  <div class="step-icon">3</div>
                  <div class="step-content">
                    <div class="step-title">–î–≤–∞ –∫—Ä—É–≥–∞ –≤—ã–±–æ—Ä–∞</div>
                    <div class="step-desc">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –≤—Å–µ 8 —Ü–≤–µ—Ç–æ–≤, –∑–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤—ã–±–æ—Ä –µ—â—ë —Ä–∞–∑.</div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="btn-group">
              <button class="btn btn-primary" id="btn-start">
                <span>üéÑ</span>
                <span>–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç</span>
              </button>
            </div>
            
            <div class="hint">
              üí° –í—ã–±–∏—Ä–∞–π—Ç–µ —Ü–≤–µ—Ç–∞ –±—ã—Å—Ç—Ä–æ! –ü–µ—Ä–≤–∞—è —Ä–µ–∞–∫—Ü–∏—è ‚Äî —Å–∞–º–∞—è —Ç–æ—á–Ω–∞—è.
            </div>
          </div>
        </section>

        <!-- –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —Ü–≤–µ—Ç–æ–≤ -->
        <section class="screen" id="screen-colors">
          <div class="card">
            <div class="progress-panel">
              <div class="progress-header">
                <div class="phase-badge" id="phase-badge">
                  <span id="phase-icon">üîÑ</span>
                  <span id="phase-text">–ö—Ä—É–≥ 1 –∏–∑ 2</span>
                </div>
                <div class="counter" id="counter">0 –∏–∑ 8</div>
              </div>
              
              <div class="progress-container">
                <div class="progress-label">
                  <span>–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                  <span id="progress-percent">0%</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" id="progress-fill"></div>
                </div>
              </div>
              
              <div class="hint" id="selection-hint">
                üé® –í—ã–±–∏—Ä–∞–π—Ç–µ —Ü–≤–µ—Ç–∞ –æ—Ç —Å–∞–º–æ–≥–æ –ø—Ä–∏—è—Ç–Ω–æ–≥–æ –∫ –Ω–∞–∏–º–µ–Ω–µ–µ –ø—Ä–∏—è—Ç–Ω–æ–º—É
              </div>
            </div>
            
            <!-- –§–ò–ö–°–ò–†–û–í–ê–ù–ù–ê–Ø –°–ï–¢–ö–ê 4x2 -->
            <div class="colors-grid" id="colors-grid">
              <!-- –í—Å–µ 8 —Ü–≤–µ—Ç–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –æ–¥–∏–Ω —Ä–∞–∑ –∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –Ω–∞ —Å–≤–æ–∏—Ö –º–µ—Å—Ç–∞—Ö -->
            </div>
          </div>
        </section>

        <!-- –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
        <section class="screen" id="screen-results">
          <div class="card results-screen">
            <div class="results-header">
              <h2 class="results-title">
                <span>üéÅ</span>
                <span>–í–∞—à–∞ –Ω–æ–≤–æ–≥–æ–¥–Ω—è—è –∏—Å—Ç–æ—Ä–∏—è 2026 –≥–æ—Ç–æ–≤–∞!</span>
              </h2>
              <p class="results-subtitle">
                –ù–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–∏—Ö —Ü–≤–µ—Ç–æ–≤—ã—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π —Å–æ–∑–¥–∞–Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –Ω–æ–≤–æ–≥–æ–¥–Ω—è—è –∏—Å—Ç–æ—Ä–∏—è
              </p>
            </div>
            
            <div class="results-groups" id="results-groups">
              <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
            
            <div class="story-container">
              <div class="story-title">
                <span>üìñ</span>
                <span>–í–∞—à–∞ –Ω–æ–≤–æ–≥–æ–¥–Ω—è—è –∏—Å—Ç–æ—Ä–∏—è 2026</span>
              </div>
              <div class="story-content" id="story-content">
                –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∞—à–µ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏...
              </div>
              <div class="new-year-wish" id="new-year-wish">
                –° –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–º –ù–æ–≤—ã–º 2026 –ì–æ–¥–æ–º! üéÑ
              </div>
            </div>
            
            <div class="results-output">
              <textarea 
                class="results-textarea" 
                id="results-output" 
                readonly
                placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –≤–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã..."
              ></textarea>
            </div>
            
            <div class="btn-group">
              <button class="btn btn-primary" id="btn-restart">
                <span>üîÑ</span>
                <span>–ü—Ä–æ–π—Ç–∏ –µ—â—ë —Ä–∞–∑</span>
              </button>
              <button class="btn btn-secondary" id="btn-copy">
                <span>üìã</span>
                <span>–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</span>
              </button>
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- –ü–æ–¥–≤–∞–ª -->
    <footer class="footer">
      <div class="container">
        <p class="footer-text">
          ‚ú® –° –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–º –ù–æ–≤—ã–º 2026 –ì–æ–¥–æ–º! –ü—É—Å—Ç—å –æ–Ω –ø—Ä–∏–Ω–µ—Å—ë—Ç –≤–∞–º —Å—á–∞—Å—Ç—å–µ –∏ –≥–∞—Ä–º–æ–Ω–∏—é
        </p>
      </div>
    </footer>
  </div>

  <script>
    // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp ---
    const tg = window.Telegram?.WebApp;
    if (tg) {
      try {
        tg.ready();
        tg.expand();
        tg.setHeaderColor('#0c1b2c');
        tg.setBackgroundColor('#0c1b2c');
      } catch (e) {
        console.log('Telegram WebApp –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ');
      }
    }

    // --- –ü–∞–ª–∏—Ç—Ä–∞ —Ü–≤–µ—Ç–æ–≤ –õ—é—à–µ—Ä–∞ (–¢–û–ß–ù–û –¢–ê–ö–ê–Ø –ñ–ï –ö–ê–ö –í –û–†–ò–ì–ò–ù–ê–õ–ï) ---
    const COLORS = [
      { id: 0, name: 'Grey', ruName: '–°–µ—Ä—ã–π', emoji: 'ü©∂', hex: '#9aa0a6' },
      { id: 1, name: 'Blue', ruName: '–°–∏–Ω–∏–π', emoji: 'üîµ', hex: '#1a73e8' },
      { id: 2, name: 'Green', ruName: '–ó–µ–ª—ë–Ω—ã–π', emoji: 'üü¢', hex: '#34a853' },
      { id: 3, name: 'Red', ruName: '–ö—Ä–∞—Å–Ω—ã–π', emoji: 'üî¥', hex: '#ea4335' },
      { id: 4, name: 'Yellow', ruName: '–ñ—ë–ª—Ç—ã–π', emoji: 'üü°', hex: '#fbbc04' },
      { id: 5, name: 'Violet', ruName: '–§–∏–æ–ª–µ—Ç–æ–≤—ã–π', emoji: 'üü£', hex: '#8e24aa' },
      { id: 6, name: 'Brown', ruName: '–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π', emoji: 'üü§', hex: '#8d6e63' },
      { id: 7, name: 'Black', ruName: '–ß—ë—Ä–Ω—ã–π', emoji: '‚ö´', hex: '#202124' },
    ];

    // --- –≠–ª–µ–º–µ–Ω—Ç—ã DOM ---
    const elements = {
      screens: {
        welcome: document.getElementById('screen-welcome'),
        colors: document.getElementById('screen-colors'),
        results: document.getElementById('screen-results')
      },
      buttons: {
        start: document.getElementById('btn-start'),
        restart: document.getElementById('btn-restart'),
        copy: document.getElementById('btn-copy')
      },
      progress: {
        phaseBadge: document.getElementById('phase-badge'),
        phaseIcon: document.getElementById('phase-icon'),
        phaseText: document.getElementById('phase-text'),
        counter: document.getElementById('counter'),
        progressFill: document.getElementById('progress-fill'),
        progressPercent: document.getElementById('progress-percent')
      },
      grid: document.getElementById('colors-grid'),
      results: {
        groups: document.getElementById('results-groups'),
        story: document.getElementById('story-content'),
        wish: document.getElementById('new-year-wish'),
        output: document.getElementById('results-output')
      }
    };

    // --- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ---
    let state = {
      phase: 1,
      picks: {
        first: [],
        second: []
      },
      colorCards: []
    };

    // --- –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞–º–∏ ---
    function showScreen(screenName) {
      Object.values(elements.screens).forEach(screen => {
        screen.classList.remove('active');
      });
      elements.screens[screenName].classList.add('active');
    }

    // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞ ---
    function startTest() {
      state = {
        phase: 1,
        picks: { first: [], second: [] },
        colorCards: []
      };
      
      createColorGrid();
      updateProgress();
      showScreen('colors');
    }

    // --- –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–µ—Ç–∫–∏ —Ü–≤–µ—Ç–æ–≤ ---
    function createColorGrid() {
      elements.grid.innerHTML = '';
      state.colorCards = [];
      
      COLORS.forEach((color, index) => {
        const colorCard = document.createElement('div');
        colorCard.className = 'color-card';
        colorCard.style.background = color.hex;
        colorCard.dataset.id = color.id;
        colorCard.dataset.index = index;
        
        const colorInfo = document.createElement('div');
        colorInfo.className = 'color-info';
        colorInfo.innerHTML = `
          <div class="color-name">${color.emoji} ${color.ruName}</div>
          <div class="color-desc">${color.meaning || color.ruName}</div>
        `;
        colorCard.appendChild(colorInfo);
        
        colorCard.onclick = () => selectColor(color.id, colorCard);
        
        elements.grid.appendChild(colorCard);
        state.colorCards.push(colorCard);
      });
    }

    // --- –í—ã–±–æ—Ä —Ü–≤–µ—Ç–∞ ---
    function selectColor(colorId, element) {
      const currentPicks = state.phase === 1 ? state.picks.first : state.picks.second;
      
      if (currentPicks.includes(colorId)) return;
      
      currentPicks.push(colorId);
      element.classList.add('selected');
      
      updateProgress();
      
      if (currentPicks.length === COLORS.length) {
        if (state.phase === 1) {
          setTimeout(() => {
            state.phase = 2;
            state.colorCards.forEach(card => {
              card.classList.remove('selected');
            });
            updateProgress();
          }, 800);
        } else {
          setTimeout(finishTest, 800);
        }
      }
    }

    // --- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ ---
    function updateProgress() {
      const currentPicks = state.phase === 1 ? state.picks.first : state.picks.second;
      const progress = (currentPicks.length / COLORS.length) * 100;
      
      elements.progress.phaseText.textContent = `–ö—Ä—É–≥ ${state.phase} –∏–∑ 2`;
      elements.progress.phaseIcon.textContent = state.phase === 1 ? 'üîÑ' : 'üéØ';
      elements.progress.counter.textContent = `${currentPicks.length} –∏–∑ ${COLORS.length}`;
      elements.progress.progressPercent.textContent = `${Math.round(progress)}%`;
      elements.progress.progressFill.style.width = `${progress}%`;
      
      const hint = document.getElementById('selection-hint');
      if (hint) {
        if (state.phase === 1) {
          hint.innerHTML = 'üé® <strong>–ö—Ä—É–≥ 1:</strong> –í—ã–±–∏—Ä–∞–π—Ç–µ —Ü–≤–µ—Ç–∞ –æ—Ç —Å–∞–º–æ–≥–æ –ø—Ä–∏—è—Ç–Ω–æ–≥–æ –∫ –Ω–∞–∏–º–µ–Ω–µ–µ –ø—Ä–∏—è—Ç–Ω–æ–º—É';
        } else {
          hint.innerHTML = 'üéØ <strong>–ö—Ä—É–≥ 2:</strong> –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤—ã–±–æ—Ä –µ—â—ë —Ä–∞–∑, —Å–ª–µ–¥—É—è —Å–≤–æ–µ–π –∏–Ω—Ç—É–∏—Ü–∏–∏';
        }
      }
    }

    // --- –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–°–û–í–ú–ï–°–¢–ò–ú–´–ô –° –û–†–ò–ì–ò–ù–ê–õ–û–ú) ---
    function analyzeResults(pick2) {
      // –°–æ–∑–¥–∞–µ–º –º–∞–ø–ø–∏–Ω–≥ –ø–æ–∑–∏—Ü–∏–π (–∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ)
      const positions = {};
      pick2.forEach((id, i) => {
        positions[id] = i;
      });
      
      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã (–∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ)
      function groupOf(pos) {
        if (pos <= 1) return '++';
        if (pos <= 3) return '+';
        if (pos <= 5) return 'x';
        return '--';
      }
      
      // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Ü–≤–µ—Ç–∞ (–∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ)
      const groups = {
        '++': [],
        '+': [],
        'x': [],
        '--': []
      };
      
      COLORS.forEach(color => {
        const pos = positions[color.id];
        const group = groupOf(pos);
        groups[group].push(color.name); // –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è –±–æ—Ç–∞
      });
      
      // –§–æ—Ä–º–∏—Ä—É–µ–º highlights (–∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ, –Ω–æ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ–¥–Ω–∏—Ö —Ç–µ–º)
      const highlights = [];
      
      if (groups['++'].includes('Black') || groups['++'].includes('Grey')) {
        highlights.push('–ó–∞–ø—Ä–æ—Å –Ω–∞ –¥–∏—Å—Ç–∞–Ω—Ü–∏—é/–≥—Ä–∞–Ω–∏—Ü—ã/—Ä–∞–∑—Ä—ã–≤. –í –Ω–æ–≤–æ–≥–æ–¥–Ω—é—é –Ω–æ—á—å —É–¥–µ–ª–∏—Ç–µ –≤—Ä–µ–º—è —Å–µ–±–µ –∏ —Å–≤–æ–∏–º –≥—Ä–∞–Ω–∏—Ü–∞–º.');
      }
      if (groups['++'].includes('Blue')) {
        highlights.push('–°–∏–ª—å–Ω–∞—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ –ø—Ä–∏–Ω—è—Ç–∏–∏ –∏ –ø–æ–∫–æ–µ. –í—Å—Ç—Ä–µ—á–∞–π—Ç–µ 2026 –≥–æ–¥ –≤ —Å–ø–æ–∫–æ–π–Ω–æ–π –æ–±—Å—Ç–∞–Ω–æ–≤–∫–µ.');
      }
      if (groups['++'].includes('Red')) {
        highlights.push('–ò–º–ø—É–ª—å—Å –∫ –¥–µ–π—Å—Ç–≤–∏—é –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É. 2026 –≥–æ–¥ –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–º –∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–º –¥–ª—è –≤–∞—Å!');
      }
      if (groups['++'].includes('Yellow')) {
        highlights.push('–ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ –Ω–∞–¥–µ–∂–¥–µ –∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ. –ù–æ–≤—ã–π –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å—ë—Ç –≤–∞–º –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.');
      }
      if (groups['--'].includes('Blue')) {
        highlights.push('–û—Ç–≤–µ—Ä–∂–µ–Ω–∏–µ —Ç–µ–ø–ª–∞ ‚Üí —Ä–∏—Å–∫ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–∏. –í 2026 –≥–æ–¥—É –æ–∫—Ä—É–∂–∏—Ç–µ —Å–µ–±—è –±–ª–∏–∑–∫–∏–º–∏.');
      }
      if (groups['--'].includes('Green')) {
        highlights.push('–û—â—É—â–µ–Ω–∏–µ —Å–Ω–∏–∂–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª—è/—Å–∞–º–æ—É–≤–∞–∂–µ–Ω–∏—è. –ù–æ–≤—ã–π –≥–æ–¥ ‚Äî –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å.');
      }
      
      // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ–¥–Ω–∏–µ –∞–∫—Ü–µ–Ω—Ç—ã
      if (groups['++'].includes('Violet')) {
        highlights.push('–¢–≤–æ—Ä—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è –ø—Ä–æ—Å–∏—Ç—Å—è –Ω–∞—Ä—É–∂—É. –í 2026 –≥–æ–¥—É —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ —Å–≤–æ–∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –∏–¥–µ–∏!');
      }
      if (groups['++'].includes('Brown')) {
        highlights.push('–°—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –∫–æ–º—Ñ–æ—Ä—Ç—É. –°–æ–∑–¥–∞–π—Ç–µ —É—é—Ç–Ω—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –¥–ª—è –≤—Å—Ç—Ä–µ—á–∏ –ù–æ–≤–æ–≥–æ –≥–æ–¥–∞.');
      }
      
      return {
        positions: positions,
        groups: groups,
        highlights: highlights
      };
    }

    // --- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–π –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è 2026 –≥–æ–¥–∞ ---
    function generateNewYearStory(analysis) {
      const groups = analysis.groups;
      let story = '';
      
      // –û—Å–Ω–æ–≤–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∞–º—ã—Ö –ª—é–±–∏–º—ã—Ö —Ü–≤–µ—Ç–æ–≤
      if (groups['++'].includes('Blue')) {
        story += "–í—Å—Ç—Ä–µ—á–∞—è 2026 –≥–æ–¥, –≤—ã –æ–±—Ä–µ—Ç—ë—Ç–µ –¥–æ–ª–≥–æ–∂–¥–∞–Ω–Ω—ã–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ–∫–æ–π. ";
      }
      if (groups['++'].includes('Red')) {
        story += "–≠–Ω–µ—Ä–≥–∏—è –∏ —Å—Ç—Ä–∞—Å—Ç—å –ø–æ–≤–µ–¥—É—Ç –≤–∞—Å –∫ –Ω–æ–≤—ã–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º –≤ –Ω–∞—Å—Ç—É–ø–∞—é—â–µ–º –≥–æ–¥—É. ";
      }
      if (groups['++'].includes('Yellow')) {
        story += "–û–ø—Ç–∏–º–∏–∑–º –∏ –Ω–∞–¥–µ–∂–¥–∞ —Å—Ç–∞–Ω—É—Ç –≤–∞—à–∏–º–∏ –≤–µ—Ä–Ω—ã–º–∏ —Å–ø—É—Ç–Ω–∏–∫–∞–º–∏ –≤ 2026 –≥–æ–¥—É. ";
      }
      if (groups['++'].includes('Green')) {
        story += "–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Å–µ–±–µ –ø–æ–º–æ–∂–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∞–º—ã–µ —Å–º–µ–ª—ã–µ –ø–ª–∞–Ω—ã. ";
      }
      
      // –ï—Å–ª–∏ –Ω–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Ü–≤–µ—Ç–æ–≤, –æ–±—â–∞—è –∏—Å—Ç–æ—Ä–∏—è
      if (!story) {
        story = "2026 –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å—ë—Ç –≤–∞–º –±–∞–ª–∞–Ω—Å –∏ –≥–∞—Ä–º–æ–Ω–∏—é –≤–æ –≤—Å–µ—Ö —Å—Ñ–µ—Ä–∞—Ö –∂–∏–∑–Ω–∏. ";
      }
      
      // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ –æ—Ç–≤–µ—Ä–≥–∞–µ–º—ã–µ —Ü–≤–µ—Ç–∞
      if (groups['--'].includes('Blue')) {
        story += "–í–æ–∑–º–æ–∂–Ω–æ, –≤—ã –∏—â–µ—Ç–µ –ø–µ—Ä–µ–º–µ–Ω –≤ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Å—Ñ–µ—Ä–µ ‚Äî –Ω–æ–≤—ã–π –≥–æ–¥ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç —Ç–∞–∫—É—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å. ";
      }
      if (groups['--'].includes('Green')) {
        story += "–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —Å–º–µ–Ω–∏—Ç—Å—è –Ω–æ–≤—ã–º–∏ —Å–∏–ª–∞–º–∏ –∏ —è—Å–Ω–æ—Å—Ç—å—é —Ü–µ–ª–µ–π. ";
      }
      
      story += "–ü–æ–¥ –±–æ–π –∫—É—Ä–∞–Ω—Ç–æ–≤ –∑–∞–≥–∞–¥–∞–π—Ç–µ —Å–∞–º–æ–µ —Å–æ–∫—Ä–æ–≤–µ–Ω–Ω–æ–µ –∂–µ–ª–∞–Ω–∏–µ ‚Äî –æ–Ω–æ –∏–º–µ–µ—Ç –≤—Å–µ —à–∞–Ω—Å—ã —Å–±—ã—Ç—å—Å—è –≤ –Ω–∞—Å—Ç—É–ø–∞—é—â–µ–º –≥–æ–¥—É.";
      
      // –ü–æ–∂–µ–ª–∞–Ω–∏–µ
      const wishes = [
        "–ü—É—Å—Ç—å 2026 –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å—ë—Ç –≤–∞–º –∑–¥–æ—Ä–æ–≤—å–µ, –ª—é–±–æ–≤—å, –ø—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏–µ –∏ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç–∏—è!",
        "–ñ–µ–ª–∞–µ–º, —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–æ–≤–æ–≥–æ –≥–æ–¥–∞ –±—ã–ª –Ω–∞–ø–æ–ª–Ω–µ–Ω —Ä–∞–¥–æ—Å—Ç—å—é, –∞ –∫–∞–∂–¥–æ–µ –Ω–∞—á–∏–Ω–∞–Ω–∏–µ ‚Äî —É—Å–ø–µ—Ö–æ–º!",
        "–ü—É—Å—Ç—å 2026 –≥–æ–¥ –±—É–¥–µ—Ç —Å–≤–µ—Ç–ª—ã–º, –∫–∞–∫ –Ω–æ–≤–æ–≥–æ–¥–Ω–∏–µ –æ–≥–Ω–∏, –∏ —Ç—ë–ø–ª—ã–º, –∫–∞–∫ —Å–µ–º–µ–π–Ω—ã–π —É—é—Ç!",
        "–ñ–µ–ª–∞–µ–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∞–º—ã—Ö –∑–∞–≤–µ—Ç–Ω—ã—Ö –∂–µ–ª–∞–Ω–∏–π –∏ —Å–≤–µ—Ç–ª—ã—Ö –Ω–∞–¥–µ–∂–¥ –≤ –Ω–∞—Å—Ç—É–ø–∞—é—â–µ–º –≥–æ–¥—É!"
      ];
      
      return {
        story: story,
        wish: wishes[Math.floor(Math.random() * wishes.length)]
      };
    }

    // --- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞ ---
    function finishTest() {
      // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–º)
      const result = analyzeResults(state.picks.second);
      
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤–æ–≥–æ–¥–Ω—é—é –∏—Å—Ç–æ—Ä–∏—é
      const story = generateNewYearStory(result);
      
      // –°–û–ó–î–ê–ï–ú –ü–ê–ô–õ–û–ê–î, –°–û–í–ú–ï–°–¢–ò–ú–´–ô –° –û–†–ò–ì–ò–ù–ê–õ–û–ú
      const payload = {
        type: 'luscher',
        version: '1.0.0',
        ts: Date.now(),
        pick1: state.picks.first,
        pick2: state.picks.second,
        result: result, // –¢–æ—Ç –∂–µ —Å–∞–º—ã–π —Ñ–æ—Ä–º–∞—Ç, —á—Ç–æ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–π —Ç–µ–º—ã (–±–æ—Ç –∏—Ö –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç, –µ—Å–ª–∏ –Ω–µ –æ–∂–∏–¥–∞–µ—Ç)
        newYearStory: story.story,
        newYearWish: story.wish,
        year: 2026
      };
      
      // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram (–¢–û–ß–ù–û –¢–ê–ö–ê–Ø –ñ–ï –ö–ê–ö –í –û–†–ò–ì–ò–ù–ê–õ–ï)
      if (tg) {
        try {
          tg.sendData(JSON.stringify(payload));
        } catch (e) {
          console.log('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ');
        }
      }
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
      displayResults(result, story);
      showScreen('results');
    }

    // --- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ---
    function displayResults(analysis, story) {
      const groups = analysis.groups;
      
      // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –≤ —Ä—É—Å—Å–∫–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
      function getRuName(engName) {
        const color = COLORS.find(c => c.name === engName);
        return color ? color.ruName : engName;
      }
      
      elements.results.groups.innerHTML = `
        <div class="result-group">
          <div class="group-header">
            <span>‚ù§Ô∏è</span>
            <span>–õ—é–±–∏–º—ã–µ —Ü–≤–µ—Ç–∞ (++)</span>
          </div>
          <div class="group-content">
            ${groups['++'].map(colorName => {
              const color = COLORS.find(c => c.name === colorName);
              return `
                <div class="color-tag" style="border-left: 3px solid ${color ? color.hex : '#ccc'}">
                  ${color ? color.emoji : ''} ${getRuName(colorName)}
                </div>
              `;
            }).join('')}
          </div>
        </div>
        
        <div class="result-group">
          <div class="group-header">
            <span>‚ú®</span>
            <span>–ü—Ä–∏—è—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞ (+)</span>
          </div>
          <div class="group-content">
            ${groups['+'].map(colorName => {
              const color = COLORS.find(c => c.name === colorName);
              return `
                <div class="color-tag" style="border-left: 3px solid ${color ? color.hex : '#ccc'}">
                  ${color ? color.emoji : ''} ${getRuName(colorName)}
                </div>
              `;
            }).join('')}
          </div>
        </div>
        
        <div class="result-group">
          <div class="group-header">
            <span>‚öñÔ∏è</span>
            <span>–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ —Ü–≤–µ—Ç–∞ (x)</span>
          </div>
          <div class="group-content">
            ${groups['x'].map(colorName => {
              const color = COLORS.find(c => c.name === colorName);
              return `
                <div class="color-tag" style="border-left: 3px solid ${color ? color.hex : '#ccc'}">
                  ${color ? color.emoji : ''} ${getRuName(colorName)}
                </div>
              `;
            }).join('')}
          </div>
        </div>
        
        <div class="result-group">
          <div class="group-header">
            <span>üåô</span>
            <span>–ù–µ–ø—Ä–∏—è—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞ (--)</span>
          </div>
          <div class="group-content">
            ${groups['--'].map(colorName => {
              const color = COLORS.find(c => c.name === colorName);
              return `
                <div class="color-tag" style="border-left: 3px solid ${color ? color.hex : '#ccc'}">
                  ${color ? color.emoji : ''} ${getRuName(colorName)}
                </div>
              `;
            }).join('')}
          </div>
        </div>
      `;
      
      elements.results.story.textContent = story.story;
      elements.results.wish.textContent = story.wish;
      
      // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–π –≤—ã–≤–æ–¥
      const output = {
        '–ù–æ–≤–æ–≥–æ–¥–Ω–∏–π —Ç–µ—Å—Ç –õ—é—à–µ—Ä–∞ 2026': '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã',
        '–î–∞—Ç–∞': new Date().toLocaleDateString('ru-RU'),
        '–õ—é–±–∏–º—ã–µ —Ü–≤–µ—Ç–∞ (++)': groups['++'].map(name => getRuName(name)).join(', '),
        '–ü—Ä–∏—è—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞ (+)': groups['+'].map(name => getRuName(name)).join(', '),
        '–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ —Ü–≤–µ—Ç–∞ (x)': groups['x'].map(name => getRuName(name)).join(', '),
        '–ù–µ–ø—Ä–∏—è—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞ (--)': groups['--'].map(name => getRuName(name)).join(', '),
        '–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å–∞–π—Ç—ã': analysis.highlights,
        '–ù–æ–≤–æ–≥–æ–¥–Ω—è—è –∏—Å—Ç–æ—Ä–∏—è 2026': story.story,
        '–ü–æ–∂–µ–ª–∞–Ω–∏–µ –Ω–∞ 2026 –≥–æ–¥': story.wish
      };
      
      elements.results.output.value = Object.entries(output)
        .map(([key, value]) => {
          if (Array.isArray(value)) {
            return `„Äê${key}„Äë\n${value.join('\n')}\n`;
          }
          return `„Äê${key}„Äë\n${value}\n`;
        })
        .join('\n');
    }

    // --- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ---
    function copyResults() {
      const textarea = elements.results.output;
      textarea.select();
      textarea.setSelectionRange(0, 99999);
      
      try {
        const successful = document.execCommand('copy');
        if (successful) {
          alert('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞! üìã');
        } else {
          navigator.clipboard.writeText(textarea.value).then(() => {
            alert('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞! üìã');
          });
        }
      } catch (err) {
        navigator.clipboard.writeText(textarea.value).then(() => {
          alert('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞! üìã');
        });
      }
    }

    // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π ---
    function initEvents() {
      elements.buttons.start.addEventListener('click', startTest);
      elements.buttons.restart.addEventListener('click', () => {
        showScreen('welcome');
      });
      elements.buttons.copy.addEventListener('click', copyResults);
    }

    // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ---
    function initApp() {
      initEvents();
      showScreen('welcome');
    }

    // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initApp);
    } else {
      initApp();
    }
  </script>
</body>
</html>
